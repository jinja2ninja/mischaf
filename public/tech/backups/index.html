<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.147.3">
    <meta name="generator" content="Relearn 8.2.0+f69a085322cc70b3e14577c0823c5bc781ec6bb2">
    <meta name="description" content="My Backup Strategy Over the years Iâ€™ve learned how important a personal data backup strategy can be. Photos are probably the most cherished piece of data to me, but there are plenty of other things that are important to keep around for many years. The conventional wisdom says that you should keep 3 copies of your data, 2 on site, and 1 somewhere else. I agree with this philosohpy, it seems like a solid way to keep things long term. As a regular home user though, this can seem a bit daunting. However these days with the advent of cloud storage, its really not that hard to achieve. In this article Iâ€™m going to explain the strategy I devloped for keeping photo backups, and how to apply it to just about anything.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="http://localhost:1313/images/og-image.png">
    <meta name="twitter:title" content="Backups :: Mischa Friegang">
    <meta name="twitter:description" content="My Backup Strategy Over the years Iâ€™ve learned how important a personal data backup strategy can be. Photos are probably the most cherished piece of data to me, but there are plenty of other things that are important to keep around for many years. The conventional wisdom says that you should keep 3 copies of your data, 2 on site, and 1 somewhere else. I agree with this philosohpy, it seems like a solid way to keep things long term. As a regular home user though, this can seem a bit daunting. However these days with the advent of cloud storage, its really not that hard to achieve. In this article Iâ€™m going to explain the strategy I devloped for keeping photo backups, and how to apply it to just about anything.">
    <meta property="og:url" content="http://localhost:1313/tech/backups/index.html">
    <meta property="og:site_name" content="Mischa Friegang">
    <meta property="og:title" content="Backups :: Mischa Friegang">
    <meta property="og:description" content="My Backup Strategy Over the years Iâ€™ve learned how important a personal data backup strategy can be. Photos are probably the most cherished piece of data to me, but there are plenty of other things that are important to keep around for many years. The conventional wisdom says that you should keep 3 copies of your data, 2 on site, and 1 somewhere else. I agree with this philosohpy, it seems like a solid way to keep things long term. As a regular home user though, this can seem a bit daunting. However these days with the advent of cloud storage, its really not that hard to achieve. In this article Iâ€™m going to explain the strategy I devloped for keeping photo backups, and how to apply it to just about anything.">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Tech">
    <meta property="article:published_time" content="2023-03-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-03-12T00:00:00+00:00">
    <meta property="og:image" content="http://localhost:1313/images/og-image.png">
    <meta itemprop="name" content="Backups :: Mischa Friegang">
    <meta itemprop="description" content="My Backup Strategy Over the years Iâ€™ve learned how important a personal data backup strategy can be. Photos are probably the most cherished piece of data to me, but there are plenty of other things that are important to keep around for many years. The conventional wisdom says that you should keep 3 copies of your data, 2 on site, and 1 somewhere else. I agree with this philosohpy, it seems like a solid way to keep things long term. As a regular home user though, this can seem a bit daunting. However these days with the advent of cloud storage, its really not that hard to achieve. In this article Iâ€™m going to explain the strategy I devloped for keeping photo backups, and how to apply it to just about anything.">
    <meta itemprop="datePublished" content="2023-03-12T00:00:00+00:00">
    <meta itemprop="dateModified" content="2023-03-12T00:00:00+00:00">
    <meta itemprop="wordCount" content="759">
    <meta itemprop="image" content="http://localhost:1313/images/og-image.png">
    <title>Backups :: Mischa Friegang</title>
    <link href="/images/favicon.png?1764125460" rel="icon" type="image/png">
    <link href="/css/auto-complete/auto-complete.min.css?1764125460" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1764125460" defer></script>
    <script src="/js/search-lunr.js?1764125460" defer></script>
    <script src="/js/search.js?1764125460" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1764125460";
    </script>
    <script src="/js/lunr/lunr.min.js?1764125460" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1764125460" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1764125460" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1764125460" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764125460" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764125460" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1764125460" rel="stylesheet">
    <link href="/css/theme.css?1764125460" rel="stylesheet">
    <link href="/css/format-html.css?1764125460" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/tech\/backups\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy text to clipboard`;
      window.T_Copied_to_clipboard = `Text copied to clipboard!`;
      window.T_Link_copied_to_clipboard = `Link copied to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      window.T_Browser_unsupported_feature = `This browser doesn't support this feature`;
      // variant stuff
      window.relearn.themevariants = [ 'dark-blue' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="/tech/backups/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#2-at-home-replicas">2 At Home Replicas</a>
      <ul>
        <li>
          <ul>
            <li><a href="#backup-script">Backup Script</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#geting-files-from-my-phone-to-the-server">Geting Files from my Phone to the Server</a></li>
    <li><a href="#off-site-backup">Off Site Backup</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/index.html"><span itemprop="name">About</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/tech/index.html"><span itemprop="name">Tech</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Backups</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="/tech/hashicorp-vault/vault_kubernetes/index.html" title="Vault on Kubernetes (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="/tech/networking/index.html" title="Network (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable tech" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="backups">Backups</h1>

<h1 id="my-backup-strategy">My Backup Strategy<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h1>
<p>Over the years I&rsquo;ve learned how important a personal data backup strategy can be. Photos are probably the most cherished piece of data to me, but there are plenty of other things that are important to keep around for many years. The conventional wisdom says that you should keep 3 copies of your data, 2 on site, and 1 somewhere else. I agree with this philosohpy, it seems like a solid way to keep things long term. As a regular home user though, this can seem a bit daunting. However these days with the advent of cloud storage, its really not that hard to achieve. In this article I&rsquo;m going to explain the strategy I devloped for keeping photo backups, and how to apply it to just about anything.</p>
<h2 id="2-at-home-replicas">2 At Home Replicas<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>To achieve the 2 at home replicas, I have tried various file server solutions including Unraid, and Truenas. These are both great, but I ultimately landed on a vanilla Ubuntu server. Its rock solid, and just about any question you could have about Ubuntu has been asked and answered on the internet. ZFS is prefectly stable on Linux now, so I saw no reason not to use it. I chose ZFS for a few reasons, native snapshots and protections against corruption being the biggest for me. With the <a href="/tech/backups/index.html">Sanoid</a> and <a href="/tech/backups/index.html">Syncoid</a> projects, backups are easy to manage.</p>
<p>ZFS allows you to create multiple datasets per pool. I have all of my datasets broken up by category, photos, music, videos, documents, etc. With Sanoid, I can create snapshots on custom schedules per dataset, depending on how important they are to me. I have a separate backup ZFS pool that I synchronize my snapshots to using Syncoid every hour. This gives me my 2 copies of data at home with relatively minimal effort. I run a cron job daily to check the health of my pools with the <code>zpool status</code> command. If anything is amiss, the healtcheck will fail, and I&rsquo;ll get an email notifying me. The service I use to monitor the cronjob is called <a href="https://healthchecks.io" rel="external">healthchecks.io</a></p>
<p>The script below runs in a cron job nightly to verify that my zfs pools are healthy.</p>
<h4 id="backup-script">Backup Script<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>status<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>sudo zpool status -x<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$status<span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;all pools are healthy&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error detected&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;</span>$status<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>curl -m <span style="color:#ae81ff">10</span> --retry <span style="color:#ae81ff">5</span> &lt;my healthcheck URL&gt;</span></span></code></pre></div>
<h2 id="geting-files-from-my-phone-to-the-server">Geting Files from my Phone to the Server<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>The first step in my backup flow is getting the photos off my phone and to the server. I have looked high and low for something better, but <a href="/tech/backups/index.html">Syncthing</a> has been the best thing I can find. I hoestly have a pretty love hate relationship with Syncthing. It has its really annoying quirks, and I have sworn I&rsquo;d never use it again more than once. At the end of the day though, all of my issues have been due to not fully undestanding how it works. When properly configured, it syncs my pictures for years at a time without any interaction. My setup is pretty simple, I set up a folder from my phone&rsquo;s storage in Syncthing to sync to a folder within a particular dataset on my ZFS pool. I personally only have these files sync while my phone is plugged into AC power to save battery.</p>
<h2 id="off-site-backup">Off Site Backup<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>The harder part is figuring out where to send the third copy. Its definitely possible to colocate with a friend or family memmber, but I don&rsquo;t want to deal with the complexity of running a backup server at someone else&rsquo;s house. It could be cheaper that way, but its an added burden, and never going to be as reliable as a cloud provider. S3 buckets are a great place to store backups, and there are some pretty cheap providers these days. I settled on <a href="/tech/backups/index.html">Wasabi</a>, but wouldn&rsquo;t mind switching to <a href="/tech/backups/index.html">Backblaze</a> sometime as their prices seem a bit cheaper. I set up buckets in Wasabi that more or less match up with the datasets on my ZFS pool.</p>
<p>To keep the data in my ZFS pool synced with my s3 bucket, I ended up creating a custom docker image. I wanted these to be scheduled with Cron so that I can avoid using up a ton of bandwidth during times we are streaming or using the internet. So I run all of my backups at night after I go to bed. I also wanted to have the ability to use my Hashicorp Vault to store the s3 credentials.</p>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Mar 12, 2023
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="https://s3.us-west-1.wasabisys.com/web-assets/blog_infra/mischa.jpeg"></img>
        </div>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="/index.html"><a class="padding" href="/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-url="/cooking/index.html"><a class="padding" href="/cooking/index.html">Cooking</a><ul id="R-subsections-ff6cde06c27bbbc8b61eda84874b21d9" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="/outdoor-trip-reports/index.html"><a class="padding" href="/outdoor-trip-reports/index.html">Outdoor Trip Reports</a><ul id="R-subsections-b09c045f8816239d145af0f772e41f30" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-url="/tech/index.html"><a class="padding" href="/tech/index.html">Tech</a><ul id="R-subsections-ceedbbae74c0ccc18084cc8e5a7d9667" class="collapsible-menu">
            <li class="alwaysopen " data-nav-url="/tech/hashicorp-vault/index.html"><a class="padding" href="/tech/hashicorp-vault/index.html">Hashicorp Vault</a><ul id="R-subsections-faa6b937ccb546eb598c2bbf9cd560e7" class="collapsible-menu"></ul></li>
            <li class="active " data-nav-url="/tech/backups/index.html"><a class="padding" href="/tech/backups/index.html">Backups</a></li>
            <li class="alwaysopen " data-nav-url="/tech/networking/index.html"><a class="padding" href="/tech/networking/index.html">Network</a><ul id="R-subsections-4d2463dfb8fc48518bce86179f129dbf" class="collapsible-menu"></ul></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1764125460" defer></script>
    <script src="/js/theme.js?1764125460" defer></script>
    <div id="toast-container" role="status" aria-live="polite" aria-atomic="false"></div>
  </body>
</html>
